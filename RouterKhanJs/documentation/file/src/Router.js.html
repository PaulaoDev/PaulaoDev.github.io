<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/Router.js</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Router.js~Router.html">Router</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/Router.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&quot;use strict&quot;;

export const Router = class {

     static create() {
      if (!Router.instance) {
       Router.instance = new this()
      }
      return Router.instance
     }

     constructor() {
      this.routes = new Map()
     }

     any(route, call) {
      if (this.routes.has(route) === false) {
       this.routes.set(route, call)
      }
     }

     toObject(names, values) {
      var result = {};
      for (var i = 0; i &lt; names.length; i++)
        result[names[i]] = values[i];
      return result;
     }

     trate(e){
        let p_call = [], i = this, p = e;
        if (this.routes.has(e) === false)
            for(var key of this.routes.keys()) 
                if(key.includes(&apos;{&apos;) &amp;&amp; key.includes(&apos;}&apos;))
                    p_call.push(key)
        if(p_call.length &gt; 0) 
            p_call = p_call.map((c) =&gt; {
                var p_test = new RegExp(c.replace(/{(.*?)}/gi, &apos;(.*)&apos;), &quot;gi&quot;),
                    p1 = new RegExp(c.replace(/{(.*?)}/gi, &apos;(.*)&apos;), &quot;gi&quot;),
                    p2 = new RegExp(c.replace(/{(.*?)}/gi, &apos;(.*)&apos;), &quot;gi&quot;);
                if(p_test.test(p) === false) return false;
                var [, ...keys] = p1.exec(c),
                    [, ...vs] = p2.exec(p);
                keys = keys.map((k) =&gt; k.replace(/[{}]/gi, &apos;&apos;))
                return {route: c,param: i.toObject(keys, vs)};
            })
            return p_call[0];
        return false
     }

     push_event(e) {
      window.history.pushState({
       url: e
      }, e, e)
      var param = this.trate(e);
      if(param) this.routes.get(param[&quot;route&quot;])(param[&quot;param&quot;]);
      if (this.routes.has(e) &amp;&amp; !param) this.routes.get(e)()
     }

     dispatch() {

      window.onpopstate = (e) =&gt; {
       var url = (window.location.hash !== &quot;&quot;) 
                 ? window.location.hash.split(&apos;#&apos;).pop() 
                 : window.location.pathname;
       this.push_event(url)
      }

      let url = (window.location.hash !== &quot;&quot;) 
                ? window.location.hash.split(&apos;#&apos;).pop() 
                : window.location.pathname;

      this.push_event(url)

     }

}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.3)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
